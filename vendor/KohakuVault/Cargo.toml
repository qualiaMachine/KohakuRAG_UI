[package]
name = "kohakuvault"
version = "0.8.0"
edition = "2021"
license = "Apache-2.0"

[lib]
name = "_kvault"     # == python module path: kohakuvault/_kvault
crate-type = ["cdylib"]
path = "src/kvault-rust/lib.rs"

[dependencies]
pyo3 = { version = "0.22", features = ["extension-module"] }
rusqlite = { version = "0.31", features = ["bundled", "blob", "unlock_notify"] }
sqlite-vec = "0.1.6"       # SQLite vector search extension
zerocopy = "0.7"           # Zero-copy vector operations
parking_lot = "0.12"
thiserror = "1.0"
crossbeam-epoch = "0.9"  # Epoch-based GC for lock-free deletion

# Serialization support for DataPacker
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
rmp-serde = "1.3"         # MessagePack
ciborium = "0.2"          # CBOR
pythonize = "0.22"        # PyDict â†” serde conversions (must match pyo3 version)
jsonschema = { version = "0.18", optional = true }  # JSON Schema validation
md5 = "0.7"               # Schema caching

[features]
default = ["schema-validation"]
schema-validation = ["jsonschema"]
